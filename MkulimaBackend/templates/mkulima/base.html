
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Kili Pesa</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    {% block leafletmeasure %}
    {% comment %} leaflet measure pre-request {% endcomment %}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" type="text/css" href={% static 'mkulima/css/leaflet/leaflet.measure.css' %} />
    <script type="text/javascript" src={% static 'mkulima/js/leaflet/leaflet.measure.js' %}></script>
    {% comment %} end {% endcomment %}
    {% endblock leafletmeasure %}

    <!-- Favicon -->
    <link href={% static 'mkulima/images/logo.jpeg' %} rel="icon">

    <!-- jquery should be top -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

    <!-- semantic ui css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css"
    integrity="sha512-KXol4x3sVoO+8ZsWPFI/r5KBVB/ssCGB5tsv2nVOKwLg33wTFP3fmnXa47FdSVIshVTgsYk/1734xSk9aFIa4A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.js"
    integrity="sha512-Xo0Jh8MsOn72LGV8kU5LsclG7SUzJsWGhXbWcYs2MAmChkQzwiW/yTQwdJ8w6UA9C6EVG18GHb/TrYpYCjyAQw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Datatables export css, when i add these css of buttons then my buttons styles changed, you can remove it if you don't want -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.dataTables.min.css" />
    <!-- end datatables export css-->

    <!--datatable date range...-->
    <link rel="stylesheet" href="https://cdn.datatables.net/datetime/1.4.1/css/dataTables.dateTime.min.css" />
    <!--end datatable date range...-->

    {% block extrasemanticuicdns %}
    
    {% endblock extrasemanticuicdns %}

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@500;700&display=swap" rel="stylesheet"> 
    
    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->

    <link href={% static "mkulima/js/darkpan/lib/owlcarousel/assets/owl.carousel.min.css" %} rel="stylesheet" />
    <link
      href={% static "mkulima/js/darkpan/lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" %}
      rel="stylesheet"
    />

    <!-- Customized Bootstrap Stylesheet -->
    <link href={% static "mkulima/css/darkpan/bootstrap.min.css" %}
    rel="stylesheet" />

    <!-- Datatables bootstrap-->
    <link href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" 
    rel="stylesheet" />
    <script src="https://cdn.datatables.net/buttons/2.3.5/css/buttons.bootstrap5.min.css"></script>

    

    {% block customscripts %}
    
    {% endblock customscripts %}

    <!-- Template Stylesheet -->
    <link href={% static "mkulima/css/darkpan/style.css" %} rel="stylesheet" />

    {% block styles %}
    
    {% endblock styles %}

    <!-- Leaflet map CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
    crossorigin=""/>

     <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
    crossorigin=""></script>

    <!-- im tired, hii link pekee ndo iliyofanya kazi on how to give color to these exports
    https://stackoverflow.com/questions/59520144/how-to-change-the-color-of-the-buttons-in-the-datatables-buttons-plugin
    --> 
    <style>
        
        {% comment %} button.dt-button, div.dt-button, a.dt-button, input.dt-button {
            border-radius: 2px;
            color: white;
            background-color: #28a745;
            text-transform: uppercase;
            font-weight: bold;
        }
        
        button.dt-button:hover:not(.disabled), div.dt-button:hover:not(.disabled), a.dt-button:hover:not(.disabled), input.dt-button:hover:not(.disabled) {
            border: 1px solid #666;
            background-color: #95D5B2;
        } {% endcomment %}
    </style>
    <!---->
</head>

<body>
    <div class="container-fluid position-relative d-flex p-0">
        <!-- Spinner Start -->
        <div id="spinner" class="show bg-dark position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <!-- Spinner End -->


        <!-- Sidebar Start -->
        <div class="sidebar pe-4 pb-3">
            <nav style="background: #fff" class="navbar">
                <a href="/" class="navbar-brand mx-4 mb-3" ><img src={% static 'mkulima/images/logo.jpeg' %} width="100" /></a>

                <div class="d-flex align-items-center ms-4 mb-4">
                    <div class="position-relative">
                        <img class="rounded-circle" src={{photo}} alt="" style="width: 40px; height: 40px;">
                        <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1"></div>
                    </div>
                    <div class="ms-3">
                        <h6 style="color: #6c7293; font-weight: bold;" class="mb-0 text-capitalize">{{fname}} {{lname}}</h6>
                        <span>
                            {% block usergroup %}

                            {% endblock %}
                        </span>
                    </div>
                </div>

                <div class="navbar-nav w-100">
                    {% block items %}
                    
                    {% endblock %}
                </div>
            </nav>
        </div>
        <!-- Sidebar End -->


        <!-- Content Start -->
        <div class="content">
            <!-- Navbar Start -->
            <nav style="background-color: #fff;" class="navbar navbar-expand navbar-dark sticky-top px-4 py-0">
                {% comment %} <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
                    <h2 class="text-primary mb-0"><i class="fa fa-user-edit"></i></h2>
                </a> {% endcomment %}
                <a href="#" id="ellipisContainer" class="sidebar-toggler flex-shrink-0">
                    <i class="fa fa-bars text-success"></i>
                </a>
                {% block searchform %}
                
                {% endblock searchform %}
               
                <div class="navbar-nav align-items-center ms-auto">
                    <div class="nav-item dropdown">
                        <div class="dropdown-menu dropdown-menu-end bg-secondary border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item text-center">See all message</a>
                        </div>
                    </div>
                    {% block printpage %}
                        
                    {% endblock printpage %}

                    {% block notification %}
                    <div class="nav-item" id="notificationCont">
                        <input type="hidden" value="{{idadinotification}}" id="idadiyanotification" />
                        <a href={% url 'notificationcenter' %} class="nav-link" id="notification">
                            <i class="fa fa-bell noti me-lg-2"></i>
                        </a>
                    </div>
                    {% endblock notification%}
                    {% block submitbtn %}
                    
                    {% endblock submitbtn %}

                    <div class="nav-item dropdown">
                        
                        
                    </div>
                    {% block optionbutton %}
                    
                    {% endblock optionbutton %}
                    <div class="nav-item dropdown" id="logoutCont">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <img class="rounded-circle me-lg-2" src={{photo}} alt="" style="width: 40px; height: 40px;">
                            <span style="color: #6c7293; font-weight: bold" class="d-none d-lg-inline-flex text-capitalize" onmouseover="this.style.color='#49A078'" onmouseout="this.style.color='#6c7293'">{{fname}} {{lname}}</span>
                        </a>
                        <div style="background: #fff" class="dropdown-menu dropdown-menu-end border-0 rounded-0 rounded-bottom m-0">
                            
                            <a href={% url 'logout' %} class="dropdown-item">Log Out</a>
                        </div>
                    </div>
                </div>
            </nav>
            <!-- Navbar End -->
            {% block content %}
        
            {% endblock content %}
        </div>
        <!-- Content End -->

        
        {% block backtotop %}
        {% comment %} <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-success btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a> {% endcomment %}
        {% endblock backtotop %}
    </div>

    <script>
        /* 
           kujua programming raha sana coz hapo mwanzo hii 'spinner' ilikuwa displayed for only 1 second but
           now i coded it to be displayed until all CDN is loaded using onreadystatechange ko no hatutegemei 
           kuona page imekuwa displayed afu tusubiri ndo pie chart itokee, THANKS GOD. na hata kama kutakuwa 
           na delay ya kutokea basi sio kwa sababu ya CDN coz tiari zishakuwa loaded.. 
       */
        document.addEventListener('readystatechange', (e) => {
           if (e.target.readyState === 'complete') {
               if (document.getElementById('spinner')) {
                   console.log('WE MADE IT')
                   document.getElementById('spinner').remove();
               }
           }
       })
   </script>


    {% block aboveBootstrapToHaveSemantic %}
    
    {% endblock aboveBootstrapToHaveSemantic %}

    {% block loadscriptaboveallscripts %}{% endblock loadscriptaboveallscripts %}
    
    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    {% comment %} this be cdn should be above labels.. {% endcomment %}
    <script src={% static "mkulima/js/darkpan/lib/chart/chart.min.js" %}></script>
    {% comment %} amelink chart yake chini ya for manipulating labels ...
    https://youtu.be/B4ph2g-LqTs 
        hii ni link ya plugin ya labels so ku-detect labels we should have 'Chart' and chart to be displayed 
        we should first link/have that chart.min.js above since its the one associated with rendering our chart 
        so you should always make sure.. SO THIS CDN/CODE OF LABELS IS EXTENSION TO chart.min.js
    {% endcomment %}
    <script src={% static "mkulima/js/darkpan/lib/chart/chartjs-plugin-labels.min.js" %}></script>

    {% comment %} <script src="https://unpkg.com/chart.js-plugin-labels-dv/dist/chartjs-plugin-labels.min.js"></script> {% endcomment %}
    <script src={% static "mkulima/js/darkpan/lib/easing/easing.min.js" %}></script>
    <script src={% static "mkulima/js/darkpan/lib/waypoints/waypoints.min.js" %}></script>
    <script src={% static "mkulima/js/darkpan/lib/owlcarousel/owl.carousel.min.js" %}></script>
    <script src={% static "mkulima/js/darkpan/lib/tempusdominus/js/moment.min.js" %}></script>
    <script src={% static "mkulima/js/darkpan/lib/tempusdominus/js/moment-timezone.min.js" %}></script>
    <script src={% static "mkulima/js/darkpan/lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js" %}></script>

    <!-- Template Javascript -->
    <!-- hapa nimetumia 'mere.js' ambayo ni adjusted to work with our project bcoz i deleted 
    configuration/getelementbyid of line-graph and other graph available in our template since they
    bring an error when it tried to get them and remember we don't use them by having an error means it stop
    the execution of down code so i removed them, this is only modification i've done...-->
    <script src={% static "mkulima/js/darkpan/mere.js" %}></script>
    
    <!-- leaflet map print browser-->
    <script src={% static "mkulima/js/leaflet/leaflet.browser.print.min.js" %}></script>
    <!-- end of leaflet map print..-->

    <!--Added now datatables export.-->
    
    {% comment %} <script src="https://code.jquery.com/jquery-3.5.1.js"></script> {% endcomment %}
    {% comment %} <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script> {% endcomment %}
    <script src={% static "mkulima/js/datatables/jquery.dataTables.min.js" %}></script>
    {% comment %} <script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script> {% endcomment %}
    <script src={% static "mkulima/js/datatables/dataTables.buttons.min.js" %}></script>
    {% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script> {% endcomment %}
    <script src={% static "mkulima/js/datatables/jszip.min.js" %}></script>

    {% comment %} datatable date range.. {% endcomment %}
    <script src="https://cdn.datatables.net/datetime/1.4.1/js/dataTables.dateTime.min.js">
    </script>
    {% comment %} end daterange {% endcomment %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script> 
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>
    <!-- end added now datatables -->

    <!-- Datatables bootstrap-->

    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>


    <script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.colVis.min.js"></script>
    {% block notificationscript %}
        <script>
            document.addEventListener("DOMContentLoaded", (e) => {
                let idadi = document.getElementById("idadiyanotification").value

                let notificationElem = document.getElementById("notification")
                let dimensions = notificationElem.getBoundingClientRect()
                let divElem = document.createElement("div")
                let spanElem = document.createElement("span")
                
                spanElem.innerText = idadi > 0 && `${idadi}`
                spanElem.style.fontWeight = "bold"
                spanElem.style.fontSize = "10px"
                spanElem.style.width = "100%"
                spanElem.style.height = "100%"
                spanElem.style.fontFamily = "monospace"
                spanElem.style.color = "#fff"
                spanElem.style.display = "flex"
                spanElem.style.justifyContent = "center"
                spanElem.style.alignItems = "center"

                divElem.appendChild(spanElem)
                divElem.style.width = "25px"
                divElem.style.height = "25px"
                divElem.style.borderRadius = "50%"
                divElem.style.background = "#E63946"
                divElem.style.display = "block"
                
                /* 
                    nilichojifunza unaweza ukaweka position fixed then pia ukaset top, left and it will 
                    behave just like position "absolute" and it will not be scrolled..  I know this is possible 
                    because what if you want given position of absolute and you want you're content to not be scrolled 
                    that's why we can use the position fixed and mutate left, right, top props just like we did 
                    in the position fixed.... OOOH I LOVE IT 
                */
                divElem.style.position = "fixed"
                divElem.style.fontSize = "17px"

                /* for your item to be displayed make sure top is not 0, otherwise you will not see your element 
                   also make sure that you have the zIndex greater than other element... */
                divElem.style.top = (dimensions.top + dimensions.bottom / 8) + "px"
                divElem.style.left = (dimensions.left + dimensions.width * 0.625) + "px"
                divElem.style.zIndex = "1234567890"
                // don't append the notification icon if there is zero notification..
                if (parseInt(idadi) > 0) {
                    document.body.appendChild(divElem)
                }


            })
        </script>
    {% endblock notificationscript%}

    {% block myscript %}
    
    {% endblock myscript %}

    
    {% block datatablelogic %}
        <script>
            $(document).ready(function() {
                $('#tableView').DataTable( {
                    "aLengthMenu": [[10, 25, 50, 100], [10, 25, 50, 100]],
                    dom: 'Bfrtip', 
                    buttons: [{
                        extend: 'csv',
                        className: 'btn btn-default',
                        exportOptions: {
                            columns: ':not(.notexport)'
                        }
                    },
                    {
                        extend: 'excel',
                        className: 'btn btn-default',
                        exportOptions: {
                            columns: ':not(.notexport)'
                        }
                    },
                    /*{
                        extend: 'pdf',
                        className: 'btn btn-default',
                        exportOptions: {
                            columns: ':not(.notexport)'
                        }
                    },*/
                    {
                        extend: 'print',
                        className: 'btn btn-default',
                        exportOptions: {
                            columns: ':not(.notexport)'
                        }
                    }
                    ],
                } );
            } );
           
        </script>
    {% endblock datatablelogic %}

</body>

</html>